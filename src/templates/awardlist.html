{% extends '__base__.html' %}
{% block title %}获奖名单{% endblock %}
{% block login_content %}
 <div class="panel">
 	<div class="panel-body search-item-wrapper">
 		<div class='search-item'>
 			学号：<input type="text" name='sno' class='form-control'>
 		</div>
 		<div class='search-item'>	
 			姓名：<input type="text" name='name' class='form-control'>
 		</div>
 		<div class='search-item' >	
 			奖项: <select name="award" class='form-control'>
 				<option value="1">第一项</option>
 				<option value="2">第二项</option>
 				<option value="3">第三项</option>
 				<option value="4">第四项</option>
 			</select>
 		</div>	
 		<div class='search-item' >	
 			年份：<select name="year" class='form-control'>
 					<option value="2006">2006</option>
					<option value="2007">2007</option>
					<option value="2008">2008</option>
					<option value="2009">2009</option>
					<option value="2010">2010</option>
					<option value="2011">2011</option>
					<option value="2012">2012</option>
					<option value="2013">2013</option>
					<option value="2014">2014</option>
					<option value="2015">2015</option>
					<option value="2014">2014</option>
					<option value="2015">2015</option>
					<option value="2016">2016</option>
					<option value="2017">2017</option>
					<option value="2018">2018</option>
					<option value="2019">2019</option>
					<option value="2020">2020</option>
					<option value="2021">2021</option>
					<option value="2022">2022</option>
					<option value="2023">2023</option>
					<option value="2024">2024</option>
 			</select>
	 	</div>
 		<div class='search-item'>
			<button class='btn btn-search'>搜索</button>
 		</div>
 	</div>
 </div>
 <div class="panel">
 	<div class="panel-body">
 		{% if students %}
 		<table class='table table-bordered'>
 			<tr class='success'><td>学号</td><td>姓名</td><td>年级</td><td>学院</td></tr>
 			<tbody class='search-body'>
 				{% for x in students %}
				<tr><td>{{x.sno}}</td><td>{{x.name}}</td><td>{{x.grade}}</td><td>{{x.college}}</td></tr>
 				{% endfor%}
 			</tbody>
 		</table>
 		{% else %}
 		<div class="alert alert-danger" role="alert">
		  当前没有学生获奖请点击<a href="/addaward" class="alert-link">[添加获奖]</a>添加
		</div>
 		{% endif %}
		
 	</div>
 </div>
{% endblock %}

{% block script %}
	<script>
		$('.btn-search').click(function(){
			var name = $('input[name=name]').val() || null;
			var sno = $('input[name=sno]').val() || null;
			var award = $('select[name=award]').val()||null;
			var year = $('select[name=year]').val()||null;
			$.ajax({
				method:'GET',
				data:{
					name:name,
					sno:sno,
					award:award,
					year:year
				},
				dataType:'json',
				url:'/api/search_award',
				success:function(response){
					if(response.code != 0 ){
						alert(response.message);
						return;
					}else{
						items = response.data;
						arr = [];
						for (var i = 0; i < items.length; i++) {
							item = items[i]
							arr.push("<tr><td>"+item.sno+"</td><td><a>"+item.name+"</a></td><td><a>"+item.award+"</a></td><td>"+item.year+"</td></tr>");
						};
						$('.search-body').html(arr.join(''))
					}
				}
			})
		})
	</script>
{% endblock%}